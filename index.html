<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autoevaluaci√≥n - 4¬∞ Bachillerato | ESCOLARIS</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --color-naranja: #db6015;
            --color-amarillo: #f7be00;
            --color-azul: #244b5a;
            --color-rojo: #993921;
            --color-blanco: #ffffff;
            --color-gris: #f0f2f5;
            --color-azul-claro: #f0f8ff;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--color-gris) 0%, var(--color-azul-claro) 100%);
            color: var(--color-azul);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* ===== ENCABEZADO ===== */
        .header {
            background: linear-gradient(135deg, var(--color-azul) 0%, var(--color-rojo) 100%);
            color: var(--color-blanco);
            padding: 40px 30px;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200px;
            height: 200px;
            background: rgba(247, 190, 0, 0.1);
            border-radius: 50%;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .lema {
            font-size: 14px;
            font-style: italic;
            opacity: 0.9;
            margin-bottom: 20px;
            letter-spacing: 1px;
        }

        .titulo-principal {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .subtitulo {
            font-size: 16px;
            opacity: 0.95;
            font-weight: 300;
        }

        /* ===== FORMULARIO ===== */
        .form-container {
            background: var(--color-blanco);
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            margin-bottom: 40px;
        }

        .section {
            margin-bottom: 35px;
        }

        .section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-azul);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--color-naranja);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-icon {
            font-size: 22px;
        }

        /* ===== GRID DE CAMPOS ===== */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-grid-full {
            grid-column: 1 / -1;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: var(--color-azul);
            margin-bottom: 8px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            padding: 12px 14px;
            border: 2px solid var(--color-gris);
            border-radius: 8px;
            font-family: inherit;
            font-size: 14px;
            color: var(--color-azul);
            transition: var(--transition);
            background-color: var(--color-blanco);
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--color-naranja);
            box-shadow: 0 0 0 3px rgba(219, 96, 21, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        /* ===== ESTADO EMOCIONAL ===== */
        .emoji-selector {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .emoji-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 12px 16px;
            border-radius: 12px;
            border: 2px solid transparent;
            transition: var(--transition);
            background-color: var(--color-gris);
        }

        .emoji-option:hover {
            transform: scale(1.08);
            background-color: var(--color-azul-claro);
        }

        .emoji-option input[type="radio"] {
            display: none;
        }

        .emoji-option input[type="radio"]:checked + .emoji-label {
            color: var(--color-naranja);
            font-weight: 700;
        }

        .emoji-option input[type="radio"]:checked ~ .emoji-icon {
            transform: scale(1.15);
            color: var(--color-naranja);
        }

        .emoji-icon {
            font-size: 32px;
            transition: var(--transition);
            margin-bottom: 6px;
        }

        .emoji-label {
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            color: var(--color-azul);
            transition: var(--transition);
        }

        /* ===== CHECKBOXES ===== */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 14px;
            background-color: var(--color-gris);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .checkbox-item:hover {
            background-color: var(--color-azul-claro);
            transform: translateX(4px);
        }

        .checkbox-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: var(--color-naranja);
        }

        .checkbox-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            text-transform: none;
            letter-spacing: normal;
            flex: 1;
        }

        /* ===== RADIO BUTTONS ===== */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background-color: var(--color-gris);
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .radio-item:hover {
            background-color: var(--color-azul-claro);
        }

        .radio-item input[type="radio"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            cursor: pointer;
            accent-color: var(--color-naranja);
        }

        .radio-item label {
            margin: 0;
            cursor: pointer;
            font-weight: 500;
            text-transform: none;
            flex: 1;
        }

        /* ===== ESCALA DE ESTRELLAS ===== */
        .stars-container {
            display: flex;
            gap: 12px;
            margin-top: 12px;
        }

        .star {
            font-size: 40px;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0.3;
        }

        .star:hover {
            opacity: 0.7;
            transform: scale(1.15);
        }

        .star.active {
            opacity: 1;
            color: var(--color-amarillo);
            text-shadow: 0 0 10px rgba(247, 190, 0, 0.5);
        }

        /* ===== RESUMEN VISUAL ===== */
        .resumen-container {
            margin-top: 40px;
            margin-bottom: 40px;
        }

        .resumen-label {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-azul);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--color-amarillo);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #resumen-visual {
            background: linear-gradient(135deg, var(--color-blanco) 0%, var(--color-azul-claro) 100%);
            border-radius: 16px;
            padding: 35px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            border: 2px solid var(--color-naranja);
        }

        .resumen-header {
            border-bottom: 3px solid var(--color-naranja);
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        .resumen-header h2 {
            font-size: 24px;
            color: var(--color-azul);
            margin-bottom: 8px;
        }

        .resumen-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            font-size: 14px;
            color: var(--color-azul);
        }

        .resumen-meta-item {
            background-color: var(--color-gris);
            padding: 8px 12px;
            border-radius: 6px;
        }

        .resumen-meta-label {
            font-weight: 600;
            color: var(--color-naranja);
        }

        .resumen-section {
            margin-bottom: 18px;
        }

        .resumen-section-title {
            font-size: 14px;
            font-weight: 700;
            color: var(--color-naranja);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .resumen-content {
            background-color: var(--color-blanco);
            padding: 12px;
            border-radius: 8px;
            color: var(--color-azul);
            font-size: 14px;
            line-height: 1.5;
            border-left: 4px solid var(--color-amarillo);
        }

        .resumen-stars {
            font-size: 28px;
            letter-spacing: 4px;
        }

        /* ===== BOTONES ===== */
        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 200px;
            justify-content: center;
        }

        .btn-descargar {
            background: linear-gradient(135deg, var(--color-naranja) 0%, #c94f0e 100%);
            color: var(--color-blanco);
            box-shadow: 0 6px 20px rgba(219, 96, 21, 0.3);
        }

        .btn-descargar:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 28px rgba(219, 96, 21, 0.4);
        }

        .btn-descargar:active {
            transform: translateY(0);
        }

        .btn-limpiar {
            background-color: var(--color-gris);
            color: var(--color-azul);
            border: 2px solid var(--color-azul);
        }

        .btn-limpiar:hover {
            background-color: var(--color-azul);
            color: var(--color-blanco);
            transform: translateY(-2px);
        }

        /* ===== TEXTO DE APOYO ===== */
        .support-text {
            background-color: var(--color-azul-claro);
            border-left: 4px solid var(--color-amarillo);
            padding: 16px;
            border-radius: 8px;
            color: var(--color-azul);
            font-size: 14px;
            line-height: 1.6;
            margin-top: 20px;
            text-align: center;
            font-style: italic;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .form-container {
                padding: 25px;
            }

            .header {
                padding: 30px 20px;
            }

            .titulo-principal {
                font-size: 22px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .emoji-selector {
                gap: 10px;
            }

            .emoji-option {
                flex: 1;
                min-width: 80px;
            }

            button {
                min-width: 160px;
                font-size: 13px;
                padding: 12px 20px;
            }

            .button-group {
                flex-direction: column;
            }

            #resumen-visual {
                padding: 20px;
            }

            .resumen-meta {
                grid-template-columns: 1fr;
            }
        }

        /* ===== ANIMACIONES ===== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-container {
            animation: fadeInUp 0.6s ease-out;
        }

        .section {
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
        }

        .section:nth-child(1) { animation-delay: 0.1s; }
        .section:nth-child(2) { animation-delay: 0.2s; }
        .section:nth-child(3) { animation-delay: 0.3s; }
        .section:nth-child(4) { animation-delay: 0.4s; }
        .section:nth-child(5) { animation-delay: 0.5s; }
        .section:nth-child(6) { animation-delay: 0.6s; }
        .section:nth-child(7) { animation-delay: 0.7s; }
        .section:nth-child(8) { animation-delay: 0.8s; }

        /* Estado deshabilitado */
        input:disabled,
        select:disabled {
            background-color: #e8e8e8;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Validaci√≥n visual */
        .form-group.complete {
            opacity: 1;
        }

        .loading {
            display: inline-block;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="header-content">
                <div class="logo">üéì ESCOLARIS</div>
                <div class="lema">Educaci√≥n para Trascender</div>
                <h1 class="titulo-principal">Autoevaluaci√≥n ‚Äì 4¬∞ Bachillerato</h1>
                <p class="subtitulo">An√°lisis y reflexi√≥n de mi proceso de aprendizaje</p>
            </div>
        </div>

        <!-- FORMULARIO -->
        <form class="form-container" id="autoevaluacionForm">
            <!-- SECCI√ìN 1: DATOS GENERALES -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">üë§</span>
                    Datos Generales del Estudiante
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nombreCompleto">Nombre Completo</label>
                        <input type="text" id="nombreCompleto" name="nombreCompleto" placeholder="Tu nombre completo" required>
                    </div>
                    <div class="form-group">
                        <label for="grado">Grado</label>
                        <input type="text" id="grado" name="grado" value="4¬∞ Bachillerato" disabled>
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="asignatura">Asignatura</label>
                        <select id="asignatura" name="asignatura" required onchange="actualizarLecciones()">
                            <option value="">-- Selecciona una asignatura --</option>
                            <optgroup label="Cursos de 12 lecciones">
                                <option value="Educaci√≥n F√≠sica">Educaci√≥n F√≠sica</option>
                                <option value="Filosof√≠a">Filosof√≠a</option>
                                <option value="Gesti√≥n de Proyectos">Gesti√≥n de Proyectos</option>
                                <option value="Ingl√©s">Ingl√©s</option>
                                <option value="Psicolog√≠a">Psicolog√≠a</option>
                                <option value="Tecnolog√≠as de la Informaci√≥n">Tecnolog√≠as de la Informaci√≥n</option>
                            </optgroup>
                            <optgroup label="Cursos de 24 lecciones">
                                <option value="Ciencias Sociales">Ciencias Sociales</option>
                                <option value="F√≠sica">F√≠sica</option>
                                <option value="Lengua y Literatura">Lengua y Literatura</option>
                                <option value="Matem√°tica">Matem√°tica</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="leccion">N√∫mero de Lecci√≥n</label>
                        <select id="leccion" name="leccion" required>
                            <option value="">-- Selecciona una lecci√≥n --</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN 2: ESTADO EMOCIONAL -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">üòä</span>
                    Estado Emocional Durante la Lecci√≥n
                </div>
                <div class="emoji-selector">
                    <label class="emoji-option">
                        <input type="radio" name="estadoEmocional" value="Muy bajo" required>
                        <span class="emoji-icon">üòû</span>
                        <span class="emoji-label">Muy bajo</span>
                    </label>
                    <label class="emoji-option">
                        <input type="radio" name="estadoEmocional" value="Bajo" required>
                        <span class="emoji-icon">üòï</span>
                        <span class="emoji-label">Bajo</span>
                    </label>
                    <label class="emoji-option">
                        <input type="radio" name="estadoEmocional" value="Aceptable" required>
                        <span class="emoji-icon">üòê</span>
                        <span class="emoji-label">Aceptable</span>
                    </label>
                    <label class="emoji-option">
                        <input type="radio" name="estadoEmocional" value="Bueno" required>
                        <span class="emoji-icon">üôÇ</span>
                        <span class="emoji-label">Bueno</span>
                    </label>
                    <label class="emoji-option">
                        <input type="radio" name="estadoEmocional" value="Muy bueno" required>
                        <span class="emoji-icon">üòÑ</span>
                        <span class="emoji-label">Muy bueno</span>
                    </label>
                </div>
            </div>

            <!-- SECCI√ìN 3: NIVEL DE COMPROMISO -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">üìò</span>
                    Nivel de Compromiso y Esfuerzo
                </div>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" name="compromiso" value="Revis√© de forma completa los recursos de la lecci√≥n">
                        <label>Revis√© de forma completa los recursos de la lecci√≥n</label>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="compromiso" value="Cumpl√≠ con las actividades asignadas">
                        <label>Cumpl√≠ con las actividades asignadas</label>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="compromiso" value="Administr√© adecuadamente mi tiempo">
                        <label>Administr√© adecuadamente mi tiempo</label>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="compromiso" value="Revis√© y mejor√© mi trabajo antes de entregarlo">
                        <label>Revis√© y mejor√© mi trabajo antes de entregarlo</label>
                    </label>
                </div>
            </div>

            <!-- SECCI√ìN 4: PARTICIPACI√ìN VIRTUAL -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">üíª</span>
                    Participaci√≥n en Reuniones Virtuales
                </div>
                <div class="radio-group">
                    <label class="radio-item">
                        <input type="radio" name="participacion" value="Particip√© de forma activa y respetuosa">
                        Particip√© de forma activa y respetuosa
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="participacion" value="Asist√≠, pero con participaci√≥n limitada">
                        Asist√≠, pero con participaci√≥n limitada
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="participacion" value="Asist√≠ con dificultades t√©cnicas">
                        Asist√≠ con dificultades t√©cnicas
                    </label>
                    <label class="radio-item">
                        <input type="radio" name="participacion" value="No se program√≥ reuni√≥n virtual">
                        No se program√≥ reuni√≥n virtual
                    </label>
                </div>
            </div>

            <!-- SECCI√ìN 5: ENTREGA DE ACTIVIDADES -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">üìù</span>
                    Entrega de Actividades
                </div>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" name="entrega" value="Entregu√© todas las actividades en la fecha establecida">
                        <label>Entregu√© todas las actividades en la fecha establecida</label>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="entrega" value="Entregu√© actividades fuera de la fecha">
                        <label>Entregu√© actividades fuera de la fecha</label>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" name="entrega" value="No logr√© entregar las actividades">
                        <label>No logr√© entregar las actividades</label>
                    </label>
                </div>
            </div>

            <!-- SECCI√ìN 6: REFLEXI√ìN ACAD√âMICA -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">‚úçÔ∏è</span>
                    Reflexi√≥n Acad√©mica Personal
                </div>
                <div class="form-grid form-grid-full">
                    <div class="form-group">
                        <label for="reflexion1">¬øQu√© conocimientos o habilidades fortalec√≠ en esta lecci√≥n?</label>
                        <textarea id="reflexion1" name="reflexion1" placeholder="Describe los aprendizajes clave..." required></textarea>
                    </div>
                </div>
                <div class="form-grid form-grid-full">
                    <div class="form-group">
                        <label for="reflexion2">¬øQu√© dificultades enfrent√© y qu√© acciones puedo tomar para mejorar?</label>
                        <textarea id="reflexion2" name="reflexion2" placeholder="Explica tus dificultades y plan de mejora..." required></textarea>
                    </div>
                </div>
                <div class="form-grid form-grid-full">
                    <div class="form-group">
                        <label for="reflexion3">¬øQu√© aspecto positivo destaco de mi desempe√±o acad√©mico en esta lecci√≥n?</label>
                        <textarea id="reflexion3" name="reflexion3" placeholder="Menciona tus logros y fortalezas..." required></textarea>
                    </div>
                </div>
            </div>

            <!-- SECCI√ìN 7: AUTOEVALUACI√ìN GLOBAL -->
            <div class="section">
                <div class="section-title">
                    <span class="section-icon">‚≠ê</span>
                    Autoevaluaci√≥n Global
                </div>
                <label style="margin-bottom: 16px; display: block; font-weight: 600; color: var(--color-azul);">¬øC√≥mo evaluar√≠as tu desempe√±o general en esta lecci√≥n?</label>
                <div class="stars-container" id="starsContainer">
                    <span class="star" data-value="1">‚≠ê</span>
                    <span class="star" data-value="2">‚≠ê</span>
                    <span class="star" data-value="3">‚≠ê</span>
                    <span class="star" data-value="4">‚≠ê</span>
                    <span class="star" data-value="5">‚≠ê</span>
                </div>
                <input type="hidden" id="calificacionEstrella" name="calificacionEstrella" value="">
            </div>

            <!-- BOTONES DE ACCI√ìN -->
            <div class="button-group">
                <button type="button" class="btn-descargar" id="btnDescargar" onclick="descargarResumen()">
                    ‚¨áÔ∏è Descargar Resumen ‚Äì PNG
                </button>
                <button type="reset" class="btn-limpiar" id="btnLimpiar">
                    üîÑ Limpiar Formulario
                </button>
            </div>
        </form>

        <!-- RESUMEN VISUAL -->
        <div class="resumen-container">
            <div class="resumen-label">
                <span class="section-icon">üìä</span>
                Resumen Visual de Resultados
            </div>
            <div id="resumen-visual">
                <div class="resumen-header">
                    <h2 id="resumenNombre">Nombre del Estudiante</h2>
                    <div class="resumen-meta">
                        <div class="resumen-meta-item"><span class="resumen-meta-label">Grado:</span> 4¬∞ Bachillerato</div>
                        <div class="resumen-meta-item"><span class="resumen-meta-label">Asignatura:</span> <span id="resumenAsignatura">--</span></div>
                        <div class="resumen-meta-item"><span class="resumen-meta-label">Lecci√≥n:</span> <span id="resumenLeccion">--</span></div>
                    </div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">üòä Estado Emocional</div>
                    <div class="resumen-content" id="resumenEmocional">No seleccionado</div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">üìò Compromiso y Esfuerzo</div>
                    <div class="resumen-content" id="resumenCompromiso">No seleccionado</div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">üíª Participaci√≥n Virtual</div>
                    <div class="resumen-content" id="resumenParticipacion">No seleccionado</div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">üìù Entrega de Actividades</div>
                    <div class="resumen-content" id="resumenEntrega">No seleccionado</div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">‚úçÔ∏è Reflexiones</div>
                    <div class="resumen-content">
                        <strong>Fortalezas y Aprendizajes:</strong>
                        <div id="resumenReflexion1" style="margin-top: 6px; padding-top: 6px; border-top: 1px solid #ddd;">No completado</div>
                    </div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-content">
                        <strong>Dificultades y Plan de Mejora:</strong>
                        <div id="resumenReflexion2" style="margin-top: 6px; padding-top: 6px; border-top: 1px solid #ddd;">No completado</div>
                    </div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-content">
                        <strong>Aspectos Positivos:</strong>
                        <div id="resumenReflexion3" style="margin-top: 6px; padding-top: 6px; border-top: 1px solid #ddd;">No completado</div>
                    </div>
                </div>

                <div class="resumen-section">
                    <div class="resumen-section-title">‚≠ê Evaluaci√≥n Global</div>
                    <div class="resumen-content resumen-stars" id="resumenEstrella">--</div>
                </div>
            </div>

            <div class="support-text">
                ‚¨áÔ∏è Descarga este resumen en formato PNG y s√∫belo a la lecci√≥n correspondiente en Canvas para que tu docente pueda revisarlo. Esta autoevaluaci√≥n forma parte de tu proceso acad√©mico.
            </div>
        </div>
    </div>

    <script>
        // ===== DATOS DE LECCIONES =====
        const leccionesPorAsignatura = {
            'Educaci√≥n F√≠sica': 12,
            'Filosof√≠a': 12,
            'Gesti√≥n de Proyectos': 12,
            'Ingl√©s': 12,
            'Psicolog√≠a': 12,
            'Tecnolog√≠as de la Informaci√≥n': 12,
            'Ciencias Sociales': 24,
            'F√≠sica': 24,
            'Lengua y Literatura': 24,
            'Matem√°tica': 24
        };

        // ===== ACTUALIZAR LECCIONES =====
        function actualizarLecciones() {
            const asignatura = document.getElementById('asignatura').value;
            const leccionSelect = document.getElementById('leccion');
            const numLecciones = leccionesPorAsignatura[asignatura] || 12;

            leccionSelect.innerHTML = '<option value="">-- Selecciona una lecci√≥n --</option>';
            
            for (let i = 1; i <= numLecciones; i++) {
                const option = document.createElement('option');
                option.value = `Lecci√≥n ${i}`;
                option.textContent = `Lecci√≥n ${i}`;
                leccionSelect.appendChild(option);
            }
        }

        // ===== ESTRELLAS =====
        document.querySelectorAll('.star').forEach(star => {
            star.addEventListener('click', function() {
                const value = this.dataset.value;
                document.getElementById('calificacionEstrella').value = value;
                
                document.querySelectorAll('.star').forEach((s, index) => {
                    if (index < value) {
                        s.classList.add('active');
                    } else {
                        s.classList.remove('active');
                    }
                });
                
                actualizarResumen();
            });

            star.addEventListener('mouseover', function() {
                const value = this.dataset.value;
                document.querySelectorAll('.star').forEach((s, index) => {
                    if (index < value) {
                        s.style.opacity = '0.7';
                    } else {
                        s.style.opacity = '0.3';
                    }
                });
            });
        });

        document.getElementById('starsContainer').addEventListener('mouseout', function() {
            document.querySelectorAll('.star').forEach(s => {
                if (!s.classList.contains('active')) {
                    s.style.opacity = '0.3';
                }
            });
        });

        // ===== ACTUALIZAR RESUMEN EN TIEMPO REAL =====
        function actualizarResumen() {
            // Nombre
            document.getElementById('resumenNombre').textContent = 
                document.getElementById('nombreCompleto').value || 'Nombre del Estudiante';

            // Asignatura y Lecci√≥n
            document.getElementById('resumenAsignatura').textContent = 
                document.getElementById('asignatura').value || '--';
            document.getElementById('resumenLeccion').textContent = 
                document.getElementById('leccion').value || '--';

            // Estado Emocional
            const estadoEmocional = document.querySelector('input[name="estadoEmocional"]:checked');
            document.getElementById('resumenEmocional').textContent = 
                estadoEmocional ? estadoEmocional.value : 'No seleccionado';

            // Compromiso
            const compromisos = Array.from(document.querySelectorAll('input[name="compromiso"]:checked'))
                .map(cb => cb.value);
            document.getElementById('resumenCompromiso').textContent = 
                compromisos.length > 0 ? compromisos.join(' ‚Ä¢ ') : 'No seleccionado';

            // Participaci√≥n
            const participacion = document.querySelector('input[name="participacion"]:checked');
            document.getElementById('resumenParticipacion').textContent = 
                participacion ? participacion.value : 'No seleccionado';

            // Entrega
            const entregas = Array.from(document.querySelectorAll('input[name="entrega"]:checked'))
                .map(cb => cb.value);
            document.getElementById('resumenEntrega').textContent = 
                entregas.length > 0 ? entregas.join(' ‚Ä¢ ') : 'No seleccionado';

            // Reflexiones
            document.getElementById('resumenReflexion1').textContent = 
                document.getElementById('reflexion1').value || 'No completado';
            document.getElementById('resumenReflexion2').textContent = 
                document.getElementById('reflexion2').value || 'No completado';
            document.getElementById('resumenReflexion3').textContent = 
                document.getElementById('reflexion3').value || 'No completado';

            // Evaluaci√≥n Global
            const estrellas = document.getElementById('calificacionEstrella').value;
            const estrellasHTML = estrellas ? '‚≠ê'.repeat(estrellas) : '--';
            document.getElementById('resumenEstrella').textContent = estrellasHTML;
        }

        // ===== LISTENERS PARA ACTUALIZAR RESUMEN =====
        document.getElementById('nombreCompleto').addEventListener('input', actualizarResumen);
        document.getElementById('asignatura').addEventListener('change', actualizarResumen);
        document.getElementById('leccion').addEventListener('change', actualizarResumen);
        document.querySelectorAll('input[name="estadoEmocional"]').forEach(input => {
            input.addEventListener('change', actualizarResumen);
        });
        document.querySelectorAll('input[name="compromiso"]').forEach(input => {
            input.addEventListener('change', actualizarResumen);
        });
        document.querySelectorAll('input[name="participacion"]').forEach(input => {
            input.addEventListener('change', actualizarResumen);
        });
        document.querySelectorAll('input[name="entrega"]').forEach(input => {
            input.addEventListener('change', actualizarResumen);
        });
        document.getElementById('reflexion1').addEventListener('input', actualizarResumen);
        document.getElementById('reflexion2').addEventListener('input', actualizarResumen);
        document.getElementById('reflexion3').addEventListener('input', actualizarResumen);

        // ===== DESCARGAR RESUMEN =====
        function descargarResumen() {
            const nombreEstudiante = document.getElementById('nombreCompleto').value;
            
            if (!nombreEstudiante) {
                alert('Por favor, ingresa tu nombre completo antes de descargar el resumen.');
                return;
            }

            const btnDescargar = document.getElementById('btnDescargar');
            btnDescargar.innerHTML = '<span class="loading">‚è≥</span> Descargando...';
            btnDescargar.disabled = true;

            const elemento = document.getElementById('resumen-visual');
            
            html2canvas(elemento, {
                scale: 2,
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true,
                allowTaint: true
            }).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = `Autoevaluacion_${nombreEstudiante.replace(/\s+/g, '_')}_${new Date().getTime()}.png`;
                link.click();

                btnDescargar.innerHTML = '‚¨áÔ∏è Descargar Resumen ‚Äì PNG';
                btnDescargar.disabled = false;
            }).catch(error => {
                console.error('Error al descargar:', error);
                alert('Hubo un error al descargar el resumen. Por favor, intenta de nuevo.');
                btnDescargar.innerHTML = '‚¨áÔ∏è Descargar Resumen ‚Äì PNG';
                btnDescargar.disabled = false;
            });
        }

        // ===== LIMPIAR FORMULARIO =====
        document.getElementById('btnLimpiar').addEventListener('click', function() {
            document.getElementById('autoevaluacionForm').reset();
            document.querySelectorAll('.star').forEach(s => s.classList.remove('active'));
            document.getElementById('calificacionEstrella').value = '';
            document.getElementById('leccion').innerHTML = '<option value="">-- Selecciona una lecci√≥n --</option>';
            actualizarResumen();
        });

        // ===== INICIALIZACI√ìN =====
        actualizarResumen();
    </script>
</body>
</html>